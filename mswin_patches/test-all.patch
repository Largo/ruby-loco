    Four mingw and/or mswin test-all fixes
    
    test/resolv/test_dns.rb
    test/ruby/test_thread.rb
    test/ruby/test_thread_queue.rb

diff --git a/test/resolv/test_dns.rb b/test/resolv/test_dns.rb
index 70d5067750..e813d039d2 100644
--- a/test/resolv/test_dns.rb
+++ b/test/resolv/test_dns.rb
@@ -169,9 +169,9 @@ def test_no_server
         }
       end
     rescue Timeout::Error
-      if RUBY_PLATFORM.match?(/mingw/)
+      if RUBY_PLATFORM.match?(/mingw|mswin/)
         # cannot repo locally
-        skip 'Timeout Error on MinGW CI'
+        skip 'Timeout Error on Windows CI'
       else
         raise Timeout::Error
       end
diff --git a/test/ruby/test_thread.rb b/test/ruby/test_thread.rb
index 30a3cc784e..565714f519 100644
--- a/test/ruby/test_thread.rb
+++ b/test/ruby/test_thread.rb
@@ -1322,6 +1322,9 @@ def test_thread_setname_in_initialize
   end
 
   def test_thread_interrupt_for_killed_thread
+    if ENV['APPVEYOR'] == 'True' && RUBY_PLATFORM.include?('mswin')
+      skip 'test has intermittent CI SIGSEGV on mswin'
+    end
     opts = { timeout: 5, timeout_error: nil }
 
     # prevent SIGABRT from slow shutdown with MJIT
diff --git a/test/ruby/test_thread_queue.rb b/test/ruby/test_thread_queue.rb
index 13c839ab50..cc7fa8e1fa 100644
--- a/test/ruby/test_thread_queue.rb
+++ b/test/ruby/test_thread_queue.rb
@@ -557,11 +557,8 @@ def test_queue_close_multi_multi
   end
 
   def test_queue_with_trap
-    if ENV['APPVEYOR'] == 'True' && RUBY_PLATFORM.match?(/mswin/)
-      skip 'This test fails too often on AppVeyor vs140'
-    end
-    if RUBY_PLATFORM.match?(/mingw/)
-      skip 'This test fails too often on MinGW'
+    if RUBY_PLATFORM.match?(/mingw|mswin/)
+      skip 'This test has timeout errors on Windows, SIGINT trap issue'
     end
 
     assert_in_out_err([], <<-INPUT, %w(INT INT exit), [])
diff --git a/test/net/smtp/test_sslcontext.rb b/test/net/smtp/test_sslcontext.rb
index 80afc1338e..ad7a708868 100644
--- a/test/net/smtp/test_sslcontext.rb
+++ b/test/net/smtp/test_sslcontext.rb
@@ -39,7 +39,7 @@ def teardown
     end
 
     def start_smtpd(starttls)
-      @server_socket, @client_socket = UNIXSocket.pair
+      @server_socket, @client_socket = Socket.pair :INET, :STREAM, 0
       @starttls_executed = false
       @server_thread = Thread.new(@server_socket) do |s|
         s.puts "220 fakeserver\r\n"
@@ -125,4 +125,4 @@ def test_start_without_tls_hostname
     end
 
   end
-end unless /mswin|mingw/ =~ RUBY_PLATFORM
+end
diff --git a/test/net/smtp/test_starttls.rb b/test/net/smtp/test_starttls.rb
index 2c812aea67..bc2db64297 100644
--- a/test/net/smtp/test_starttls.rb
+++ b/test/net/smtp/test_starttls.rb
@@ -25,7 +25,7 @@ def teardown
     end
 
     def start_smtpd(starttls)
-      @server_socket, @client_socket = UNIXSocket.pair
+      @server_socket, @client_socket = Socket.pair :INET, :STREAM, 0
       @starttls_executed = false
       @server_thread = Thread.new(@server_socket) do |s|
         s.puts "220 fakeserver\r\n"
@@ -118,4 +118,4 @@ def test_enable_starttls_and_enable_starttls_auto
       assert_nothing_raised { smtp.enable_starttls_auto }
     end
   end
-end unless /mswin|mingw/ =~ RUBY_PLATFORM
+end
