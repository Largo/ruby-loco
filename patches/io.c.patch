Patch from Issue 13546
See https://bugs.ruby-lang.org/issues/13546
diff --git a/io.c b/io.c
index 0f6afb7bc4..3e8cdad75f 100644
--- a/io.c
+++ b/io.c
@@ -641,7 +641,11 @@ void
 rb_io_check_closed(rb_io_t *fptr)
 {
     rb_io_check_initialized(fptr);
+#ifdef WIN32
+    if ((fptr->fd < 0) && (fptr->fd != -2) ) {
+#else
     if (fptr->fd < 0) {
+#endif
 	rb_raise(rb_eIOError, closed_stream);
     }
 }
